{"ast":null,"code":"var _jsxFileName = \"/Users/peytonhollenback/Cod3/Multi-Frontend-Discogs-Helper/react-front/src/components/UserInfo/CollectionScreen.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useAuthContext } from '../../AuthContext';\nimport { useApi } from '../../utility/backSource';\nimport { useDiscogs } from '../../utility/dataSource';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CollectionScreen = () => {\n  _s();\n  const [collection, setCollection] = useState([]);\n  const [folders, setFolders] = useState([]);\n  const [selectedFolder, setSelectedFolder] = useState(1); // Default to \"Uncategorized\"\n  const [syncing, setSyncing] = useState(false);\n  const {\n    authState\n  } = useAuthContext();\n  const {\n    getData: getDiscogsData,\n    deleteData: deleteDiscogsData\n  } = useDiscogs();\n  const {\n    getData: getBackendData,\n    updateData,\n    deleteData: deleteBackendData,\n    postData\n  } = useApi();\n  const userInitiatedSync = useRef(false);\n  useEffect(() => {\n    userInitiatedSync.current = false;\n    loadFolders();\n    syncCollection();\n    // eslint-disable-next-line\n  }, [selectedFolder]);\n  const loadFolders = async () => {\n    try {\n      const foldersData = await getDiscogsData(`/users/${authState.username}/collection/folders`);\n      setFolders(foldersData.folders || []);\n    } catch (err) {\n      console.error('Failed to load folders:', err);\n    }\n  };\n  const syncCollection = async () => {\n    setSyncing(true);\n    try {\n      console.log('Starting collection sync...');\n      // Fetch collection from Discogs API\n      const discogsData = await getDiscogsData(`/users/${authState.username}/collection/folders/${selectedFolder}/releases`);\n      console.log('Raw Discogs data:', discogsData);\n      const mapped = discogsData.releases.map(release => {\n        console.log('Processing release:', release);\n\n        // Safely extract artist names\n        let artistNames = '';\n        if (release.basic_information.artists && Array.isArray(release.basic_information.artists)) {\n          artistNames = release.basic_information.artists.map(a => a && typeof a === 'object' && a.name ? a.name : '').filter(name => name !== '').join(', ');\n        }\n\n        // Safely extract genres\n        let genres = '';\n        if (release.basic_information.genres && Array.isArray(release.basic_information.genres)) {\n          genres = release.basic_information.genres.map(g => typeof g === 'string' ? g : '').filter(g => g !== '').join(', ');\n        }\n\n        // Ensure all values are strings, numbers, or null\n        const mappedItem = {\n          discogs_id: release.basic_information.id || null,\n          instance_id: release.instance_id || null,\n          thumb: typeof release.basic_information.thumb === 'string' ? release.basic_information.thumb : '',\n          title: typeof release.basic_information.title === 'string' ? release.basic_information.title : '',\n          artist: artistNames,\n          genre: genres,\n          releaseYear: typeof release.basic_information.year === 'number' ? release.basic_information.year.toString() : '',\n          styles: Array.isArray(release.basic_information.styles) ? release.basic_information.styles.join(', ') : '',\n          notes: typeof release.notes === 'string' ? release.notes : '',\n          rating: typeof release.rating === 'number' ? release.rating : 0,\n          price_threshold: '',\n          cover: typeof release.basic_information.cover_image === 'string' ? release.basic_information.cover_image : '',\n          folder_id: selectedFolder\n        };\n        console.log('Mapped item:', mappedItem);\n        return mappedItem;\n      });\n\n      // Fetch backend collection for this user\n      const backendCollection = await getBackendData(`/api/users/${authState.userId}/collection`);\n      console.log('Backend collection:', backendCollection);\n\n      // Merge backend fields into collection\n      const merged = mapped.map(item => {\n        const backendItem = backendCollection.find(b => b.discogs_id === item.discogs_id);\n        const mergedItem = backendItem ? {\n          ...item,\n          notes: typeof backendItem.notes === 'string' ? backendItem.notes : item.notes || '',\n          rating: typeof backendItem.rating === 'number' ? backendItem.rating : item.rating || 0,\n          price_threshold: typeof backendItem.price_threshold === 'string' || typeof backendItem.price_threshold === 'number' ? backendItem.price_threshold.toString() : ''\n        } : item;\n        console.log('Merged item:', mergedItem);\n        return mergedItem;\n      });\n      setCollection(merged);\n      console.log('Final collection:', merged);\n      if (userInitiatedSync.current) {\n        alert('Synced with Discogs!');\n      }\n    } catch (err) {\n      console.error('Sync error:', err);\n      alert('Failed to sync with Discogs.');\n    } finally {\n      setSyncing(false);\n    }\n  };\n  const handleEditClick = async (discogsId, instanceId) => {\n    var _item$rating, _item$price_threshold;\n    const item = collection.find(i => i.discogs_id === discogsId && i.instance_id === instanceId);\n    const newNotes = prompt('Edit notes:', (item === null || item === void 0 ? void 0 : item.notes) || '');\n    if (newNotes === null) return;\n    const newRatingStr = prompt('Edit rating (0-5):', (item === null || item === void 0 ? void 0 : (_item$rating = item.rating) === null || _item$rating === void 0 ? void 0 : _item$rating.toString()) || '0');\n    if (newRatingStr === null) return;\n    const newRating = parseInt(newRatingStr, 10);\n    if (isNaN(newRating) || newRating < 0 || newRating > 5) {\n      alert('Invalid rating. Must be 0-5.');\n      return;\n    }\n    const newPriceThresholdStr = prompt('Edit price threshold:', (item === null || item === void 0 ? void 0 : (_item$price_threshold = item.price_threshold) === null || _item$price_threshold === void 0 ? void 0 : _item$price_threshold.toString()) || '');\n    if (newPriceThresholdStr === null) return;\n    const newPriceThreshold = parseFloat(newPriceThresholdStr);\n    if (isNaN(newPriceThreshold)) {\n      alert('Invalid price threshold.');\n      return;\n    }\n    try {\n      console.log('Updating Discogs collection:', {\n        endpoint: `/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`,\n        method: 'PUT',\n        data: {\n          notes: newNotes,\n          rating: newRating\n        },\n        notes: newNotes,\n        rating: newRating\n      });\n\n      // Update rating and notes on Discogs\n      // TODO: Discogs API update is currently failing with 405 error\n      // Need to investigate correct endpoint for updating collection items\n      // For now, just update the backend database\n      /*\n      const discogsResp = await putDiscogsData(`/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`, {\n          notes: newNotes,\n          rating: newRating\n      });\n      console.log('Discogs PUT response:', discogsResp);\n      */\n\n      // Check if item exists in backend collection\n      const backendCollection = await getBackendData(`/api/users/${authState.userId}/collection`);\n      const existingItem = backendCollection.find(b => b.discogs_id === discogsId);\n      let backendResp;\n      if (existingItem) {\n        // Update existing item\n        console.log('Updating existing backend item:', {\n          endpoint: `/api/users/${authState.userId}/collection/${discogsId}`,\n          price_threshold: newPriceThreshold,\n          rating: newRating,\n          notes: newNotes\n        });\n        backendResp = await updateData(`/api/users/${authState.userId}/collection/${discogsId}`, {\n          price_threshold: newPriceThreshold,\n          rating: newRating,\n          notes: newNotes\n        });\n      } else {\n        // Create new item\n        console.log('Creating new backend item:', {\n          endpoint: `/api/users/${authState.userId}/collection`,\n          discogsId: discogsId,\n          price_threshold: newPriceThreshold,\n          rating: newRating,\n          notes: newNotes\n        });\n        backendResp = await postData(`/api/users/${authState.userId}/collection`, {\n          userId: authState.userId,\n          discogsId: discogsId,\n          title: item.title || '',\n          artist: item.artist || '',\n          genre: item.genre || '',\n          releaseYear: item.releaseYear || '',\n          styles: item.styles || '',\n          rating: newRating,\n          notes: newNotes,\n          price_threshold: newPriceThreshold,\n          wishlist: 0\n        });\n      }\n      console.log('Backend response:', backendResp);\n\n      // Update UI\n      setCollection(collection.map(item => item.discogs_id === discogsId && item.instance_id === instanceId ? {\n        ...item,\n        notes: newNotes,\n        rating: newRating,\n        price_threshold: newPriceThreshold\n      } : item));\n    } catch (err) {\n      console.error('Failed to update item:', err);\n      alert('Failed to update item.');\n    }\n  };\n  const handleDeleteClick = async (discogsId, instanceId) => {\n    try {\n      console.log('Deleting from Discogs collection:', {\n        endpoint: `/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`,\n        discogsId,\n        instanceId\n      });\n\n      // Delete from Discogs API\n      const discogsResp = await deleteDiscogsData(`/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`);\n      console.log('Discogs DELETE response:', discogsResp);\n      console.log('Deleting from backend:', {\n        endpoint: `/api/users/${authState.userId}/collection/${discogsId}`,\n        discogsId\n      });\n\n      // Delete from backend database\n      const backendResp = await deleteBackendData(`/api/users/${authState.userId}/collection/${discogsId}`);\n      console.log('Backend DELETE response:', backendResp);\n\n      // Update UI\n      setCollection(collection.filter(item => !(item.discogs_id === discogsId && item.instance_id === instanceId)));\n    } catch (err) {\n      console.error('Failed to delete item:', err);\n      alert('Failed to delete item from collection.');\n    }\n  };\n  const handleSyncClick = () => {\n    userInitiatedSync.current = true;\n    syncCollection();\n  };\n\n  // Helper function to safely convert any value to a string\n  const safeToString = value => {\n    if (value === null || value === undefined) return '';\n    if (typeof value === 'string') return value;\n    if (typeof value === 'number') return value.toString();\n    if (typeof value === 'boolean') return value.toString();\n    if (Array.isArray(value)) return value.join(', ');\n    if (typeof value === 'object') {\n      console.warn('Attempting to render object:', value);\n      console.warn('Object keys:', Object.keys(value));\n      console.warn('Object values:', Object.values(value));\n      if (value.field_id && value.value) {\n        console.warn('Found field_id/value object:', value);\n        return `[${value.field_id}: ${value.value}]`;\n      }\n      return '[Object]';\n    }\n    return String(value);\n  };\n  const renderCollectionItems = () => {\n    return collection.map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: [/*#__PURE__*/_jsxDEV(\"th\", {\n        scope: \"row\",\n        children: safeToString(item.discogs_id)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.instance_id)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: item.thumb ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: item.thumb,\n          alt: safeToString(item.title),\n          style: {\n            width: '50px',\n            height: '50px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"No image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.title)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.artist)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.genre)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.notes)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.rating)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: safeToString(item.price_threshold)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-primary btn-sm\",\n          onClick: () => handleEditClick(item.discogs_id, item.instance_id),\n          children: \"EDIT\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-danger btn-sm\",\n          onClick: () => handleDeleteClick(item.discogs_id, item.instance_id),\n          children: \"DELETE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 17\n      }, this)]\n    }, `${item.discogs_id}-${item.instance_id}`, true, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 13\n    }, this));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"mx-5\",\n      children: /*#__PURE__*/_jsxDEV(\"u\", {\n        children: [authState.username, \"'s Collection!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-5 my-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        className: \"form-select d-inline-block w-auto me-3\",\n        value: selectedFolder,\n        onChange: e => setSelectedFolder(parseInt(e.target.value)),\n        children: folders.map(folder => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: folder.id,\n          children: [folder.name, \" (\", folder.count, \" items)\"]\n        }, folder.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-success\",\n        onClick: handleSyncClick,\n        disabled: syncing,\n        children: syncing ? 'Syncing...' : 'Sync with Discogs'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        className: \"text-muted ms-2\",\n        children: \"Note: Discogs API has rate limits. Large collections may take time to sync.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"table\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Discogs #\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Instance #\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Cover\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Artist\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Genre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Notes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Rating\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Price Threshold\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            scope: \"col\",\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: renderCollectionItems()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 305,\n    columnNumber: 9\n  }, this);\n};\n_s(CollectionScreen, \"Ybkwj7HqVpIV2NGIkBK12mWaMNc=\", false, function () {\n  return [useAuthContext, useDiscogs, useApi];\n});\n_c = CollectionScreen;\nexport default CollectionScreen;\nvar _c;\n$RefreshReg$(_c, \"CollectionScreen\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useAuthContext","useApi","useDiscogs","jsxDEV","_jsxDEV","CollectionScreen","_s","collection","setCollection","folders","setFolders","selectedFolder","setSelectedFolder","syncing","setSyncing","authState","getData","getDiscogsData","deleteData","deleteDiscogsData","getBackendData","updateData","deleteBackendData","postData","userInitiatedSync","current","loadFolders","syncCollection","foldersData","username","err","console","error","log","discogsData","mapped","releases","map","release","artistNames","basic_information","artists","Array","isArray","a","name","filter","join","genres","g","mappedItem","discogs_id","id","instance_id","thumb","title","artist","genre","releaseYear","year","toString","styles","notes","rating","price_threshold","cover","cover_image","folder_id","backendCollection","userId","merged","item","backendItem","find","b","mergedItem","alert","handleEditClick","discogsId","instanceId","_item$rating","_item$price_threshold","i","newNotes","prompt","newRatingStr","newRating","parseInt","isNaN","newPriceThresholdStr","newPriceThreshold","parseFloat","endpoint","method","data","existingItem","backendResp","wishlist","handleDeleteClick","discogsResp","handleSyncClick","safeToString","value","undefined","warn","Object","keys","values","field_id","String","renderCollectionItems","children","scope","fileName","_jsxFileName","lineNumber","columnNumber","src","alt","style","width","height","type","className","onClick","onChange","e","target","folder","count","disabled","_c","$RefreshReg$"],"sources":["/Users/peytonhollenback/Cod3/Multi-Frontend-Discogs-Helper/react-front/src/components/UserInfo/CollectionScreen.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useAuthContext } from '../../AuthContext';\nimport { useApi } from '../../utility/backSource';\nimport { useDiscogs } from '../../utility/dataSource';\n\nconst CollectionScreen = () => {\n    const [collection, setCollection] = useState([]);\n    const [folders, setFolders] = useState([]);\n    const [selectedFolder, setSelectedFolder] = useState(1); // Default to \"Uncategorized\"\n    const [syncing, setSyncing] = useState(false);\n    const { authState } = useAuthContext();\n    const { getData: getDiscogsData, deleteData: deleteDiscogsData } = useDiscogs();\n    const { getData: getBackendData, updateData, deleteData: deleteBackendData, postData } = useApi();\n    const userInitiatedSync = useRef(false);\n\n    useEffect(() => {\n        userInitiatedSync.current = false;\n        loadFolders();\n        syncCollection();\n        // eslint-disable-next-line\n    }, [selectedFolder]);\n\n    const loadFolders = async () => {\n        try {\n            const foldersData = await getDiscogsData(`/users/${authState.username}/collection/folders`);\n            setFolders(foldersData.folders || []);\n        } catch (err) {\n            console.error('Failed to load folders:', err);\n        }\n    };\n\n    const syncCollection = async () => {\n        setSyncing(true);\n        try {\n            console.log('Starting collection sync...');\n            // Fetch collection from Discogs API\n            const discogsData = await getDiscogsData(`/users/${authState.username}/collection/folders/${selectedFolder}/releases`);\n            console.log('Raw Discogs data:', discogsData);\n            \n            const mapped = discogsData.releases.map(release => {\n                console.log('Processing release:', release);\n                \n                // Safely extract artist names\n                let artistNames = '';\n                if (release.basic_information.artists && Array.isArray(release.basic_information.artists)) {\n                    artistNames = release.basic_information.artists\n                        .map(a => (a && typeof a === 'object' && a.name) ? a.name : '')\n                        .filter(name => name !== '')\n                        .join(', ');\n                }\n                \n                // Safely extract genres\n                let genres = '';\n                if (release.basic_information.genres && Array.isArray(release.basic_information.genres)) {\n                    genres = release.basic_information.genres\n                        .map(g => (typeof g === 'string') ? g : '')\n                        .filter(g => g !== '')\n                        .join(', ');\n                }\n                \n                // Ensure all values are strings, numbers, or null\n                const mappedItem = {\n                    discogs_id: release.basic_information.id || null,\n                    instance_id: release.instance_id || null,\n                    thumb: (typeof release.basic_information.thumb === 'string') ? release.basic_information.thumb : '',\n                    title: (typeof release.basic_information.title === 'string') ? release.basic_information.title : '',\n                    artist: artistNames,\n                    genre: genres,\n                    releaseYear: (typeof release.basic_information.year === 'number') ? release.basic_information.year.toString() : '',\n                    styles: Array.isArray(release.basic_information.styles) \n                        ? release.basic_information.styles.join(', ')\n                        : '',\n                    notes: (typeof release.notes === 'string') ? release.notes : '',\n                    rating: (typeof release.rating === 'number') ? release.rating : 0,\n                    price_threshold: '',\n                    cover: (typeof release.basic_information.cover_image === 'string') ? release.basic_information.cover_image : '',\n                    folder_id: selectedFolder\n                };\n                \n                console.log('Mapped item:', mappedItem);\n                return mappedItem;\n            });\n            \n            // Fetch backend collection for this user\n            const backendCollection = await getBackendData(`/api/users/${authState.userId}/collection`);\n            console.log('Backend collection:', backendCollection);\n            \n            // Merge backend fields into collection\n            const merged = mapped.map(item => {\n                const backendItem = backendCollection.find(b => b.discogs_id === item.discogs_id);\n                const mergedItem = backendItem ? {\n                    ...item,\n                    notes: (typeof backendItem.notes === 'string') ? backendItem.notes : (item.notes || ''),\n                    rating: (typeof backendItem.rating === 'number') ? backendItem.rating : (item.rating || 0),\n                    price_threshold: (typeof backendItem.price_threshold === 'string' || typeof backendItem.price_threshold === 'number') ? backendItem.price_threshold.toString() : ''\n                } : item;\n                \n                console.log('Merged item:', mergedItem);\n                return mergedItem;\n            });\n            \n            setCollection(merged);\n            console.log('Final collection:', merged);\n            if (userInitiatedSync.current) {\n                alert('Synced with Discogs!');\n            }\n        } catch (err) {\n            console.error('Sync error:', err);\n            alert('Failed to sync with Discogs.');\n        } finally {\n            setSyncing(false);\n        }\n    };\n\n    const handleEditClick = async (discogsId, instanceId) => {\n        const item = collection.find(i => i.discogs_id === discogsId && i.instance_id === instanceId);\n        const newNotes = prompt('Edit notes:', item?.notes || '');\n        if (newNotes === null) return;\n        const newRatingStr = prompt('Edit rating (0-5):', item?.rating?.toString() || '0');\n        if (newRatingStr === null) return;\n        const newRating = parseInt(newRatingStr, 10);\n        if (isNaN(newRating) || newRating < 0 || newRating > 5) {\n            alert('Invalid rating. Must be 0-5.');\n            return;\n        }\n        const newPriceThresholdStr = prompt('Edit price threshold:', item?.price_threshold?.toString() || '');\n        if (newPriceThresholdStr === null) return;\n        const newPriceThreshold = parseFloat(newPriceThresholdStr);\n        if (isNaN(newPriceThreshold)) {\n            alert('Invalid price threshold.');\n            return;\n        }\n        try {\n            console.log('Updating Discogs collection:', {\n                endpoint: `/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`,\n                method: 'PUT',\n                data: {\n                    notes: newNotes,\n                    rating: newRating\n                },\n                notes: newNotes,\n                rating: newRating\n            });\n            \n            // Update rating and notes on Discogs\n            // TODO: Discogs API update is currently failing with 405 error\n            // Need to investigate correct endpoint for updating collection items\n            // For now, just update the backend database\n            /*\n            const discogsResp = await putDiscogsData(`/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`, {\n                notes: newNotes,\n                rating: newRating\n            });\n            console.log('Discogs PUT response:', discogsResp);\n            */\n            \n            // Check if item exists in backend collection\n            const backendCollection = await getBackendData(`/api/users/${authState.userId}/collection`);\n            const existingItem = backendCollection.find(b => b.discogs_id === discogsId);\n            \n            let backendResp;\n            if (existingItem) {\n                // Update existing item\n                console.log('Updating existing backend item:', {\n                    endpoint: `/api/users/${authState.userId}/collection/${discogsId}`,\n                    price_threshold: newPriceThreshold,\n                    rating: newRating,\n                    notes: newNotes\n                });\n                backendResp = await updateData(`/api/users/${authState.userId}/collection/${discogsId}`, { \n                    price_threshold: newPriceThreshold, \n                    rating: newRating, \n                    notes: newNotes \n                });\n            } else {\n                // Create new item\n                console.log('Creating new backend item:', {\n                    endpoint: `/api/users/${authState.userId}/collection`,\n                    discogsId: discogsId,\n                    price_threshold: newPriceThreshold,\n                    rating: newRating,\n                    notes: newNotes\n                });\n                backendResp = await postData(`/api/users/${authState.userId}/collection`, {\n                    userId: authState.userId,\n                    discogsId: discogsId,\n                    title: item.title || '',\n                    artist: item.artist || '',\n                    genre: item.genre || '',\n                    releaseYear: item.releaseYear || '',\n                    styles: item.styles || '',\n                    rating: newRating,\n                    notes: newNotes,\n                    price_threshold: newPriceThreshold,\n                    wishlist: 0\n                });\n            }\n            console.log('Backend response:', backendResp);\n            \n            // Update UI\n            setCollection(collection.map(item =>\n                (item.discogs_id === discogsId && item.instance_id === instanceId)\n                    ? { ...item, notes: newNotes, rating: newRating, price_threshold: newPriceThreshold }\n                    : item\n            ));\n        } catch (err) {\n            console.error('Failed to update item:', err);\n            alert('Failed to update item.');\n        }\n    };\n\n    const handleDeleteClick = async (discogsId, instanceId) => {\n        try {\n            console.log('Deleting from Discogs collection:', {\n                endpoint: `/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`,\n                discogsId,\n                instanceId\n            });\n            \n            // Delete from Discogs API\n            const discogsResp = await deleteDiscogsData(`/users/${authState.username}/collection/folders/${selectedFolder}/releases/${discogsId}/instances/${instanceId}`);\n            console.log('Discogs DELETE response:', discogsResp);\n            \n            console.log('Deleting from backend:', {\n                endpoint: `/api/users/${authState.userId}/collection/${discogsId}`,\n                discogsId\n            });\n            \n            // Delete from backend database\n            const backendResp = await deleteBackendData(`/api/users/${authState.userId}/collection/${discogsId}`);\n            console.log('Backend DELETE response:', backendResp);\n            \n            // Update UI\n            setCollection(collection.filter(item => !(item.discogs_id === discogsId && item.instance_id === instanceId)));\n        } catch (err) {\n            console.error('Failed to delete item:', err);\n            alert('Failed to delete item from collection.');\n        }\n    };\n\n    const handleSyncClick = () => {\n        userInitiatedSync.current = true;\n        syncCollection();\n    };\n\n    // Helper function to safely convert any value to a string\n    const safeToString = (value) => {\n        if (value === null || value === undefined) return '';\n        if (typeof value === 'string') return value;\n        if (typeof value === 'number') return value.toString();\n        if (typeof value === 'boolean') return value.toString();\n        if (Array.isArray(value)) return value.join(', ');\n        if (typeof value === 'object') {\n            console.warn('Attempting to render object:', value);\n            console.warn('Object keys:', Object.keys(value));\n            console.warn('Object values:', Object.values(value));\n            if (value.field_id && value.value) {\n                console.warn('Found field_id/value object:', value);\n                return `[${value.field_id}: ${value.value}]`;\n            }\n            return '[Object]';\n        }\n        return String(value);\n    };\n\n    const renderCollectionItems = () => {\n        return collection.map((item) => (\n            <tr key={`${item.discogs_id}-${item.instance_id}`}>\n                <th scope=\"row\">{safeToString(item.discogs_id)}</th>\n                <td>{safeToString(item.instance_id)}</td>\n                <td>\n                    {item.thumb ? (\n                        <img src={item.thumb} alt={safeToString(item.title)} style={{width: '50px', height: '50px'}} />\n                    ) : (\n                        <span>No image</span>\n                    )}\n                </td>\n                <td>{safeToString(item.title)}</td>\n                <td>{safeToString(item.artist)}</td>\n                <td>{safeToString(item.genre)}</td>\n                <td>{safeToString(item.notes)}</td>\n                <td>{safeToString(item.rating)}</td>\n                <td>{safeToString(item.price_threshold)}</td>\n                <td>\n                    <button \n                        type='button' \n                        className='btn btn-primary btn-sm' \n                        onClick={() => handleEditClick(item.discogs_id, item.instance_id)}>\n                        EDIT\n                    </button>\n                </td>\n                <td>\n                    <button \n                        type='button' \n                        className='btn btn-danger btn-sm' \n                        onClick={() => handleDeleteClick(item.discogs_id, item.instance_id)}>\n                        DELETE\n                    </button>\n                </td>\n            </tr>\n        ));\n    };\n\n    return (\n        <div>\n            <h1 className='mx-5'>\n                <u>{authState.username}'s Collection!</u>\n            </h1>\n            <div className='mx-5 my-2'>\n                <select \n                    className='form-select d-inline-block w-auto me-3' \n                    value={selectedFolder} \n                    onChange={(e) => setSelectedFolder(parseInt(e.target.value))}>\n                    {folders.map(folder => (\n                        <option key={folder.id} value={folder.id}>\n                            {folder.name} ({folder.count} items)\n                        </option>\n                    ))}\n                </select>\n                <button className='btn btn-success' onClick={handleSyncClick} disabled={syncing}>\n                    {syncing ? 'Syncing...' : 'Sync with Discogs'}\n                </button>\n                <small className='text-muted ms-2'>\n                    Note: Discogs API has rate limits. Large collections may take time to sync.\n                </small>\n            </div>\n            <table className=\"table\">\n                <thead>\n                    <tr>\n                        <th scope=\"col\">Discogs #</th>\n                        <th scope=\"col\">Instance #</th>\n                        <th scope=\"col\">Cover</th>\n                        <th scope=\"col\">Title</th>\n                        <th scope=\"col\">Artist</th>\n                        <th scope=\"col\">Genre</th>\n                        <th scope=\"col\">Notes</th>\n                        <th scope=\"col\">Rating</th>\n                        <th scope=\"col\">Price Threshold</th>\n                        <th scope=\"col\">Actions</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {renderCollectionItems()}\n                </tbody>\n            </table>\n        </div>\n    );\n};\n\nexport default CollectionScreen;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,cAAc,QAAQ,mBAAmB;AAClD,SAASC,MAAM,QAAQ,0BAA0B;AACjD,SAASC,UAAU,QAAQ,0BAA0B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtD,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACY,OAAO,EAAEC,UAAU,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACc,cAAc,EAAEC,iBAAiB,CAAC,GAAGf,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;EACzD,MAAM,CAACgB,OAAO,EAAEC,UAAU,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM;IAAEkB;EAAU,CAAC,GAAGf,cAAc,CAAC,CAAC;EACtC,MAAM;IAAEgB,OAAO,EAAEC,cAAc;IAAEC,UAAU,EAAEC;EAAkB,CAAC,GAAGjB,UAAU,CAAC,CAAC;EAC/E,MAAM;IAAEc,OAAO,EAAEI,cAAc;IAAEC,UAAU;IAAEH,UAAU,EAAEI,iBAAiB;IAAEC;EAAS,CAAC,GAAGtB,MAAM,CAAC,CAAC;EACjG,MAAMuB,iBAAiB,GAAGzB,MAAM,CAAC,KAAK,CAAC;EAEvCD,SAAS,CAAC,MAAM;IACZ0B,iBAAiB,CAACC,OAAO,GAAG,KAAK;IACjCC,WAAW,CAAC,CAAC;IACbC,cAAc,CAAC,CAAC;IAChB;EACJ,CAAC,EAAE,CAAChB,cAAc,CAAC,CAAC;EAEpB,MAAMe,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC5B,IAAI;MACA,MAAME,WAAW,GAAG,MAAMX,cAAc,CAAC,UAAUF,SAAS,CAACc,QAAQ,qBAAqB,CAAC;MAC3FnB,UAAU,CAACkB,WAAW,CAACnB,OAAO,IAAI,EAAE,CAAC;IACzC,CAAC,CAAC,OAAOqB,GAAG,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;IACjD;EACJ,CAAC;EAED,MAAMH,cAAc,GAAG,MAAAA,CAAA,KAAY;IAC/Bb,UAAU,CAAC,IAAI,CAAC;IAChB,IAAI;MACAiB,OAAO,CAACE,GAAG,CAAC,6BAA6B,CAAC;MAC1C;MACA,MAAMC,WAAW,GAAG,MAAMjB,cAAc,CAAC,UAAUF,SAAS,CAACc,QAAQ,uBAAuBlB,cAAc,WAAW,CAAC;MACtHoB,OAAO,CAACE,GAAG,CAAC,mBAAmB,EAAEC,WAAW,CAAC;MAE7C,MAAMC,MAAM,GAAGD,WAAW,CAACE,QAAQ,CAACC,GAAG,CAACC,OAAO,IAAI;QAC/CP,OAAO,CAACE,GAAG,CAAC,qBAAqB,EAAEK,OAAO,CAAC;;QAE3C;QACA,IAAIC,WAAW,GAAG,EAAE;QACpB,IAAID,OAAO,CAACE,iBAAiB,CAACC,OAAO,IAAIC,KAAK,CAACC,OAAO,CAACL,OAAO,CAACE,iBAAiB,CAACC,OAAO,CAAC,EAAE;UACvFF,WAAW,GAAGD,OAAO,CAACE,iBAAiB,CAACC,OAAO,CAC1CJ,GAAG,CAACO,CAAC,IAAKA,CAAC,IAAI,OAAOA,CAAC,KAAK,QAAQ,IAAIA,CAAC,CAACC,IAAI,GAAID,CAAC,CAACC,IAAI,GAAG,EAAE,CAAC,CAC9DC,MAAM,CAACD,IAAI,IAAIA,IAAI,KAAK,EAAE,CAAC,CAC3BE,IAAI,CAAC,IAAI,CAAC;QACnB;;QAEA;QACA,IAAIC,MAAM,GAAG,EAAE;QACf,IAAIV,OAAO,CAACE,iBAAiB,CAACQ,MAAM,IAAIN,KAAK,CAACC,OAAO,CAACL,OAAO,CAACE,iBAAiB,CAACQ,MAAM,CAAC,EAAE;UACrFA,MAAM,GAAGV,OAAO,CAACE,iBAAiB,CAACQ,MAAM,CACpCX,GAAG,CAACY,CAAC,IAAK,OAAOA,CAAC,KAAK,QAAQ,GAAIA,CAAC,GAAG,EAAE,CAAC,CAC1CH,MAAM,CAACG,CAAC,IAAIA,CAAC,KAAK,EAAE,CAAC,CACrBF,IAAI,CAAC,IAAI,CAAC;QACnB;;QAEA;QACA,MAAMG,UAAU,GAAG;UACfC,UAAU,EAAEb,OAAO,CAACE,iBAAiB,CAACY,EAAE,IAAI,IAAI;UAChDC,WAAW,EAAEf,OAAO,CAACe,WAAW,IAAI,IAAI;UACxCC,KAAK,EAAG,OAAOhB,OAAO,CAACE,iBAAiB,CAACc,KAAK,KAAK,QAAQ,GAAIhB,OAAO,CAACE,iBAAiB,CAACc,KAAK,GAAG,EAAE;UACnGC,KAAK,EAAG,OAAOjB,OAAO,CAACE,iBAAiB,CAACe,KAAK,KAAK,QAAQ,GAAIjB,OAAO,CAACE,iBAAiB,CAACe,KAAK,GAAG,EAAE;UACnGC,MAAM,EAAEjB,WAAW;UACnBkB,KAAK,EAAET,MAAM;UACbU,WAAW,EAAG,OAAOpB,OAAO,CAACE,iBAAiB,CAACmB,IAAI,KAAK,QAAQ,GAAIrB,OAAO,CAACE,iBAAiB,CAACmB,IAAI,CAACC,QAAQ,CAAC,CAAC,GAAG,EAAE;UAClHC,MAAM,EAAEnB,KAAK,CAACC,OAAO,CAACL,OAAO,CAACE,iBAAiB,CAACqB,MAAM,CAAC,GACjDvB,OAAO,CAACE,iBAAiB,CAACqB,MAAM,CAACd,IAAI,CAAC,IAAI,CAAC,GAC3C,EAAE;UACRe,KAAK,EAAG,OAAOxB,OAAO,CAACwB,KAAK,KAAK,QAAQ,GAAIxB,OAAO,CAACwB,KAAK,GAAG,EAAE;UAC/DC,MAAM,EAAG,OAAOzB,OAAO,CAACyB,MAAM,KAAK,QAAQ,GAAIzB,OAAO,CAACyB,MAAM,GAAG,CAAC;UACjEC,eAAe,EAAE,EAAE;UACnBC,KAAK,EAAG,OAAO3B,OAAO,CAACE,iBAAiB,CAAC0B,WAAW,KAAK,QAAQ,GAAI5B,OAAO,CAACE,iBAAiB,CAAC0B,WAAW,GAAG,EAAE;UAC/GC,SAAS,EAAExD;QACf,CAAC;QAEDoB,OAAO,CAACE,GAAG,CAAC,cAAc,EAAEiB,UAAU,CAAC;QACvC,OAAOA,UAAU;MACrB,CAAC,CAAC;;MAEF;MACA,MAAMkB,iBAAiB,GAAG,MAAMhD,cAAc,CAAC,cAAcL,SAAS,CAACsD,MAAM,aAAa,CAAC;MAC3FtC,OAAO,CAACE,GAAG,CAAC,qBAAqB,EAAEmC,iBAAiB,CAAC;;MAErD;MACA,MAAME,MAAM,GAAGnC,MAAM,CAACE,GAAG,CAACkC,IAAI,IAAI;QAC9B,MAAMC,WAAW,GAAGJ,iBAAiB,CAACK,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACvB,UAAU,KAAKoB,IAAI,CAACpB,UAAU,CAAC;QACjF,MAAMwB,UAAU,GAAGH,WAAW,GAAG;UAC7B,GAAGD,IAAI;UACPT,KAAK,EAAG,OAAOU,WAAW,CAACV,KAAK,KAAK,QAAQ,GAAIU,WAAW,CAACV,KAAK,GAAIS,IAAI,CAACT,KAAK,IAAI,EAAG;UACvFC,MAAM,EAAG,OAAOS,WAAW,CAACT,MAAM,KAAK,QAAQ,GAAIS,WAAW,CAACT,MAAM,GAAIQ,IAAI,CAACR,MAAM,IAAI,CAAE;UAC1FC,eAAe,EAAG,OAAOQ,WAAW,CAACR,eAAe,KAAK,QAAQ,IAAI,OAAOQ,WAAW,CAACR,eAAe,KAAK,QAAQ,GAAIQ,WAAW,CAACR,eAAe,CAACJ,QAAQ,CAAC,CAAC,GAAG;QACrK,CAAC,GAAGW,IAAI;QAERxC,OAAO,CAACE,GAAG,CAAC,cAAc,EAAE0C,UAAU,CAAC;QACvC,OAAOA,UAAU;MACrB,CAAC,CAAC;MAEFnE,aAAa,CAAC8D,MAAM,CAAC;MACrBvC,OAAO,CAACE,GAAG,CAAC,mBAAmB,EAAEqC,MAAM,CAAC;MACxC,IAAI9C,iBAAiB,CAACC,OAAO,EAAE;QAC3BmD,KAAK,CAAC,sBAAsB,CAAC;MACjC;IACJ,CAAC,CAAC,OAAO9C,GAAG,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,aAAa,EAAEF,GAAG,CAAC;MACjC8C,KAAK,CAAC,8BAA8B,CAAC;IACzC,CAAC,SAAS;MACN9D,UAAU,CAAC,KAAK,CAAC;IACrB;EACJ,CAAC;EAED,MAAM+D,eAAe,GAAG,MAAAA,CAAOC,SAAS,EAAEC,UAAU,KAAK;IAAA,IAAAC,YAAA,EAAAC,qBAAA;IACrD,MAAMV,IAAI,GAAGhE,UAAU,CAACkE,IAAI,CAACS,CAAC,IAAIA,CAAC,CAAC/B,UAAU,KAAK2B,SAAS,IAAII,CAAC,CAAC7B,WAAW,KAAK0B,UAAU,CAAC;IAC7F,MAAMI,QAAQ,GAAGC,MAAM,CAAC,aAAa,EAAE,CAAAb,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAET,KAAK,KAAI,EAAE,CAAC;IACzD,IAAIqB,QAAQ,KAAK,IAAI,EAAE;IACvB,MAAME,YAAY,GAAGD,MAAM,CAAC,oBAAoB,EAAE,CAAAb,IAAI,aAAJA,IAAI,wBAAAS,YAAA,GAAJT,IAAI,CAAER,MAAM,cAAAiB,YAAA,uBAAZA,YAAA,CAAcpB,QAAQ,CAAC,CAAC,KAAI,GAAG,CAAC;IAClF,IAAIyB,YAAY,KAAK,IAAI,EAAE;IAC3B,MAAMC,SAAS,GAAGC,QAAQ,CAACF,YAAY,EAAE,EAAE,CAAC;IAC5C,IAAIG,KAAK,CAACF,SAAS,CAAC,IAAIA,SAAS,GAAG,CAAC,IAAIA,SAAS,GAAG,CAAC,EAAE;MACpDV,KAAK,CAAC,8BAA8B,CAAC;MACrC;IACJ;IACA,MAAMa,oBAAoB,GAAGL,MAAM,CAAC,uBAAuB,EAAE,CAAAb,IAAI,aAAJA,IAAI,wBAAAU,qBAAA,GAAJV,IAAI,CAAEP,eAAe,cAAAiB,qBAAA,uBAArBA,qBAAA,CAAuBrB,QAAQ,CAAC,CAAC,KAAI,EAAE,CAAC;IACrG,IAAI6B,oBAAoB,KAAK,IAAI,EAAE;IACnC,MAAMC,iBAAiB,GAAGC,UAAU,CAACF,oBAAoB,CAAC;IAC1D,IAAID,KAAK,CAACE,iBAAiB,CAAC,EAAE;MAC1Bd,KAAK,CAAC,0BAA0B,CAAC;MACjC;IACJ;IACA,IAAI;MACA7C,OAAO,CAACE,GAAG,CAAC,8BAA8B,EAAE;QACxC2D,QAAQ,EAAE,UAAU7E,SAAS,CAACc,QAAQ,uBAAuBlB,cAAc,aAAamE,SAAS,cAAcC,UAAU,EAAE;QAC3Hc,MAAM,EAAE,KAAK;QACbC,IAAI,EAAE;UACFhC,KAAK,EAAEqB,QAAQ;UACfpB,MAAM,EAAEuB;QACZ,CAAC;QACDxB,KAAK,EAAEqB,QAAQ;QACfpB,MAAM,EAAEuB;MACZ,CAAC,CAAC;;MAEF;MACA;MACA;MACA;MACA;AACZ;AACA;AACA;AACA;AACA;AACA;;MAEY;MACA,MAAMlB,iBAAiB,GAAG,MAAMhD,cAAc,CAAC,cAAcL,SAAS,CAACsD,MAAM,aAAa,CAAC;MAC3F,MAAM0B,YAAY,GAAG3B,iBAAiB,CAACK,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACvB,UAAU,KAAK2B,SAAS,CAAC;MAE5E,IAAIkB,WAAW;MACf,IAAID,YAAY,EAAE;QACd;QACAhE,OAAO,CAACE,GAAG,CAAC,iCAAiC,EAAE;UAC3C2D,QAAQ,EAAE,cAAc7E,SAAS,CAACsD,MAAM,eAAeS,SAAS,EAAE;UAClEd,eAAe,EAAE0B,iBAAiB;UAClC3B,MAAM,EAAEuB,SAAS;UACjBxB,KAAK,EAAEqB;QACX,CAAC,CAAC;QACFa,WAAW,GAAG,MAAM3E,UAAU,CAAC,cAAcN,SAAS,CAACsD,MAAM,eAAeS,SAAS,EAAE,EAAE;UACrFd,eAAe,EAAE0B,iBAAiB;UAClC3B,MAAM,EAAEuB,SAAS;UACjBxB,KAAK,EAAEqB;QACX,CAAC,CAAC;MACN,CAAC,MAAM;QACH;QACApD,OAAO,CAACE,GAAG,CAAC,4BAA4B,EAAE;UACtC2D,QAAQ,EAAE,cAAc7E,SAAS,CAACsD,MAAM,aAAa;UACrDS,SAAS,EAAEA,SAAS;UACpBd,eAAe,EAAE0B,iBAAiB;UAClC3B,MAAM,EAAEuB,SAAS;UACjBxB,KAAK,EAAEqB;QACX,CAAC,CAAC;QACFa,WAAW,GAAG,MAAMzE,QAAQ,CAAC,cAAcR,SAAS,CAACsD,MAAM,aAAa,EAAE;UACtEA,MAAM,EAAEtD,SAAS,CAACsD,MAAM;UACxBS,SAAS,EAAEA,SAAS;UACpBvB,KAAK,EAAEgB,IAAI,CAAChB,KAAK,IAAI,EAAE;UACvBC,MAAM,EAAEe,IAAI,CAACf,MAAM,IAAI,EAAE;UACzBC,KAAK,EAAEc,IAAI,CAACd,KAAK,IAAI,EAAE;UACvBC,WAAW,EAAEa,IAAI,CAACb,WAAW,IAAI,EAAE;UACnCG,MAAM,EAAEU,IAAI,CAACV,MAAM,IAAI,EAAE;UACzBE,MAAM,EAAEuB,SAAS;UACjBxB,KAAK,EAAEqB,QAAQ;UACfnB,eAAe,EAAE0B,iBAAiB;UAClCO,QAAQ,EAAE;QACd,CAAC,CAAC;MACN;MACAlE,OAAO,CAACE,GAAG,CAAC,mBAAmB,EAAE+D,WAAW,CAAC;;MAE7C;MACAxF,aAAa,CAACD,UAAU,CAAC8B,GAAG,CAACkC,IAAI,IAC5BA,IAAI,CAACpB,UAAU,KAAK2B,SAAS,IAAIP,IAAI,CAAClB,WAAW,KAAK0B,UAAU,GAC3D;QAAE,GAAGR,IAAI;QAAET,KAAK,EAAEqB,QAAQ;QAAEpB,MAAM,EAAEuB,SAAS;QAAEtB,eAAe,EAAE0B;MAAkB,CAAC,GACnFnB,IACV,CAAC,CAAC;IACN,CAAC,CAAC,OAAOzC,GAAG,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEF,GAAG,CAAC;MAC5C8C,KAAK,CAAC,wBAAwB,CAAC;IACnC;EACJ,CAAC;EAED,MAAMsB,iBAAiB,GAAG,MAAAA,CAAOpB,SAAS,EAAEC,UAAU,KAAK;IACvD,IAAI;MACAhD,OAAO,CAACE,GAAG,CAAC,mCAAmC,EAAE;QAC7C2D,QAAQ,EAAE,UAAU7E,SAAS,CAACc,QAAQ,uBAAuBlB,cAAc,aAAamE,SAAS,cAAcC,UAAU,EAAE;QAC3HD,SAAS;QACTC;MACJ,CAAC,CAAC;;MAEF;MACA,MAAMoB,WAAW,GAAG,MAAMhF,iBAAiB,CAAC,UAAUJ,SAAS,CAACc,QAAQ,uBAAuBlB,cAAc,aAAamE,SAAS,cAAcC,UAAU,EAAE,CAAC;MAC9JhD,OAAO,CAACE,GAAG,CAAC,0BAA0B,EAAEkE,WAAW,CAAC;MAEpDpE,OAAO,CAACE,GAAG,CAAC,wBAAwB,EAAE;QAClC2D,QAAQ,EAAE,cAAc7E,SAAS,CAACsD,MAAM,eAAeS,SAAS,EAAE;QAClEA;MACJ,CAAC,CAAC;;MAEF;MACA,MAAMkB,WAAW,GAAG,MAAM1E,iBAAiB,CAAC,cAAcP,SAAS,CAACsD,MAAM,eAAeS,SAAS,EAAE,CAAC;MACrG/C,OAAO,CAACE,GAAG,CAAC,0BAA0B,EAAE+D,WAAW,CAAC;;MAEpD;MACAxF,aAAa,CAACD,UAAU,CAACuC,MAAM,CAACyB,IAAI,IAAI,EAAEA,IAAI,CAACpB,UAAU,KAAK2B,SAAS,IAAIP,IAAI,CAAClB,WAAW,KAAK0B,UAAU,CAAC,CAAC,CAAC;IACjH,CAAC,CAAC,OAAOjD,GAAG,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEF,GAAG,CAAC;MAC5C8C,KAAK,CAAC,wCAAwC,CAAC;IACnD;EACJ,CAAC;EAED,MAAMwB,eAAe,GAAGA,CAAA,KAAM;IAC1B5E,iBAAiB,CAACC,OAAO,GAAG,IAAI;IAChCE,cAAc,CAAC,CAAC;EACpB,CAAC;;EAED;EACA,MAAM0E,YAAY,GAAIC,KAAK,IAAK;IAC5B,IAAIA,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKC,SAAS,EAAE,OAAO,EAAE;IACpD,IAAI,OAAOD,KAAK,KAAK,QAAQ,EAAE,OAAOA,KAAK;IAC3C,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE,OAAOA,KAAK,CAAC1C,QAAQ,CAAC,CAAC;IACtD,IAAI,OAAO0C,KAAK,KAAK,SAAS,EAAE,OAAOA,KAAK,CAAC1C,QAAQ,CAAC,CAAC;IACvD,IAAIlB,KAAK,CAACC,OAAO,CAAC2D,KAAK,CAAC,EAAE,OAAOA,KAAK,CAACvD,IAAI,CAAC,IAAI,CAAC;IACjD,IAAI,OAAOuD,KAAK,KAAK,QAAQ,EAAE;MAC3BvE,OAAO,CAACyE,IAAI,CAAC,8BAA8B,EAAEF,KAAK,CAAC;MACnDvE,OAAO,CAACyE,IAAI,CAAC,cAAc,EAAEC,MAAM,CAACC,IAAI,CAACJ,KAAK,CAAC,CAAC;MAChDvE,OAAO,CAACyE,IAAI,CAAC,gBAAgB,EAAEC,MAAM,CAACE,MAAM,CAACL,KAAK,CAAC,CAAC;MACpD,IAAIA,KAAK,CAACM,QAAQ,IAAIN,KAAK,CAACA,KAAK,EAAE;QAC/BvE,OAAO,CAACyE,IAAI,CAAC,8BAA8B,EAAEF,KAAK,CAAC;QACnD,OAAO,IAAIA,KAAK,CAACM,QAAQ,KAAKN,KAAK,CAACA,KAAK,GAAG;MAChD;MACA,OAAO,UAAU;IACrB;IACA,OAAOO,MAAM,CAACP,KAAK,CAAC;EACxB,CAAC;EAED,MAAMQ,qBAAqB,GAAGA,CAAA,KAAM;IAChC,OAAOvG,UAAU,CAAC8B,GAAG,CAAEkC,IAAI,iBACvBnE,OAAA;MAAA2G,QAAA,gBACI3G,OAAA;QAAI4G,KAAK,EAAC,KAAK;QAAAD,QAAA,EAAEV,YAAY,CAAC9B,IAAI,CAACpB,UAAU;MAAC;QAAA8D,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACpDhH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAAClB,WAAW;MAAC;QAAA4D,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACzChH,OAAA;QAAA2G,QAAA,EACKxC,IAAI,CAACjB,KAAK,gBACPlD,OAAA;UAAKiH,GAAG,EAAE9C,IAAI,CAACjB,KAAM;UAACgE,GAAG,EAAEjB,YAAY,CAAC9B,IAAI,CAAChB,KAAK,CAAE;UAACgE,KAAK,EAAE;YAACC,KAAK,EAAE,MAAM;YAAEC,MAAM,EAAE;UAAM;QAAE;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,gBAE/FhH,OAAA;UAAA2G,QAAA,EAAM;QAAQ;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM;MACvB;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eACLhH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAAChB,KAAK;MAAC;QAAA0D,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACnChH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAACf,MAAM;MAAC;QAAAyD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACpChH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAACd,KAAK;MAAC;QAAAwD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACnChH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAACT,KAAK;MAAC;QAAAmD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACnChH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAACR,MAAM;MAAC;QAAAkD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACpChH,OAAA;QAAA2G,QAAA,EAAKV,YAAY,CAAC9B,IAAI,CAACP,eAAe;MAAC;QAAAiD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAC7ChH,OAAA;QAAA2G,QAAA,eACI3G,OAAA;UACIsH,IAAI,EAAC,QAAQ;UACbC,SAAS,EAAC,wBAAwB;UAClCC,OAAO,EAAEA,CAAA,KAAM/C,eAAe,CAACN,IAAI,CAACpB,UAAU,EAAEoB,IAAI,CAAClB,WAAW,CAAE;UAAA0D,QAAA,EAAC;QAEvE;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACT,CAAC,eACLhH,OAAA;QAAA2G,QAAA,eACI3G,OAAA;UACIsH,IAAI,EAAC,QAAQ;UACbC,SAAS,EAAC,uBAAuB;UACjCC,OAAO,EAAEA,CAAA,KAAM1B,iBAAiB,CAAC3B,IAAI,CAACpB,UAAU,EAAEoB,IAAI,CAAClB,WAAW,CAAE;UAAA0D,QAAA,EAAC;QAEzE;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACT,CAAC;IAAA,GA/BA,GAAG7C,IAAI,CAACpB,UAAU,IAAIoB,IAAI,CAAClB,WAAW,EAAE;MAAA4D,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAgC7C,CACP,CAAC;EACN,CAAC;EAED,oBACIhH,OAAA;IAAA2G,QAAA,gBACI3G,OAAA;MAAIuH,SAAS,EAAC,MAAM;MAAAZ,QAAA,eAChB3G,OAAA;QAAA2G,QAAA,GAAIhG,SAAS,CAACc,QAAQ,EAAC,gBAAc;MAAA;QAAAoF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzC,CAAC,eACLhH,OAAA;MAAKuH,SAAS,EAAC,WAAW;MAAAZ,QAAA,gBACtB3G,OAAA;QACIuH,SAAS,EAAC,wCAAwC;QAClDrB,KAAK,EAAE3F,cAAe;QACtBkH,QAAQ,EAAGC,CAAC,IAAKlH,iBAAiB,CAAC2E,QAAQ,CAACuC,CAAC,CAACC,MAAM,CAACzB,KAAK,CAAC,CAAE;QAAAS,QAAA,EAC5DtG,OAAO,CAAC4B,GAAG,CAAC2F,MAAM,iBACf5H,OAAA;UAAwBkG,KAAK,EAAE0B,MAAM,CAAC5E,EAAG;UAAA2D,QAAA,GACpCiB,MAAM,CAACnF,IAAI,EAAC,IAAE,EAACmF,MAAM,CAACC,KAAK,EAAC,SACjC;QAAA,GAFaD,MAAM,CAAC5E,EAAE;UAAA6D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAEd,CACX;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,eACThH,OAAA;QAAQuH,SAAS,EAAC,iBAAiB;QAACC,OAAO,EAAExB,eAAgB;QAAC8B,QAAQ,EAAErH,OAAQ;QAAAkG,QAAA,EAC3ElG,OAAO,GAAG,YAAY,GAAG;MAAmB;QAAAoG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzC,CAAC,eACThH,OAAA;QAAOuH,SAAS,EAAC,iBAAiB;QAAAZ,QAAA,EAAC;MAEnC;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACP,CAAC,eACNhH,OAAA;MAAOuH,SAAS,EAAC,OAAO;MAAAZ,QAAA,gBACpB3G,OAAA;QAAA2G,QAAA,eACI3G,OAAA;UAAA2G,QAAA,gBACI3G,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC9BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAU;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC/BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC1BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC1BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAM;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC3BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC1BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC1BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAM;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC3BhH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAe;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACpChH,OAAA;YAAI4G,KAAK,EAAC,KAAK;YAAAD,QAAA,EAAC;UAAO;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5B;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC,eACRhH,OAAA;QAAA2G,QAAA,EACKD,qBAAqB,CAAC;MAAC;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrB,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACP,CAAC;AAEd,CAAC;AAAC9G,EAAA,CAtVID,gBAAgB;EAAA,QAKIL,cAAc,EAC+BE,UAAU,EACYD,MAAM;AAAA;AAAAkI,EAAA,GAP7F9H,gBAAgB;AAwVtB,eAAeA,gBAAgB;AAAC,IAAA8H,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}